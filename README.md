# Parser
parser of sites synapsenet.ru and rusprofile.ru
Описание работы.
Перед началом работы в папку parser поместите свою таблицу с данными в формате xlsx. Удалите старые таблицы, иначе программа может работать с ними. Запустите файл main.exe. Дождитесь окончания работы программы. Результат сохранен в файл res.xlsx.
Программа без пользовательского интерфейса (он и не нужен, взаимодействия с программой нет). Берет данные из таблицы, помещенной в туже папку, что и exe файл программы. Это название организации и ее адрес. Осуществляет поиск на сайте https://synapsenet.ru/ ИНН по названию, затем из списка организаций с похожими названиями выбирает ту, у которой почтовый индекс совпадает с индексом, указанном в адресе организации (другие данные из адреса не используются). Если такой организации не нашлось, делает тоже самое на сайте https://www.rusprofile.ru/. Если и это не удалось – в ячейке ИНН напротив названия организации будет значиться «Ошибка». Нужно будет проверить правильность названия организации и ее адрес. Все результаты сохраняются в файл «res.xlsx».
Требования программы.
1.	Подключение к интернету (При отсутствии ошибка: requests.exceptions.ConnectionError: HTTPSConnectionPool(host='synapsenet.ru', port=443): Max retries exceeded with url: /searchorganization/proverka-kontragentov?query=%D0%9E%D0%9…).
2.	Форма таблицы (расположение столбцов с данными) должна быть точно такой, как в Вашем примере. Столбец «А» - название, столбец «В» - адрес. ИНН будет записываться в столбец «С». Первая строчка игнорируется, т.е. названия столбцов можно менять.
3.	Адрес должен начинаться с 6-тизначного почтового индекса организации. Индекс должен точно соответствовать юридическому адресу (В примере у «Общество с Ограниченной Ответственностью "Алан-Тревел"» индекс не точный, в нем зашифровано только название города, без конкретного почтового отделения. В этом случае выбирается организация с наиболее близким названием. Поиск по адресу практически бесполезен, т.к. даже если 1 символ не такой как в базе – организация не находится).
4.	Название таблицы не должно быть «res.xlsx» чтобы избежать путаницы, т.к. в этот файл сохраняются результаты. Если нужного файла не найдется на 10 секунд выведется сообщение «Поместите вашу таблицу в формате xlsx в папку с программой и перезапустите программу. Название не должно быть res.xlsx» и программа закроется.
5.	Сайт https://www.rusprofile.ru/ не позволяет делать большое количество запросов и блокирует соединение с такого ip. Если в таблице получилось много ошибок, попробуйте зайти на https://www.rusprofile.ru/ в браузере. Возможно, попросит пройти проверку «Я не робот». Пройдите. На какое-то время это должно помочь. Страшного тут я ничего не вижу – основной сайт -https://synapsenet.ru/ не доставляет таких проблем. 
6.	Если будут организации, с правильным адресом и названием, по которым программа не находит ИНН – присылайте мне их данные – программу подправлю.

Приятного пользования!
